(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))u(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&u(n)}).observe(document,{childList:!0,subtree:!0});function s(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(e){if(e.ep)return;e.ep=!0;const o=s(e);fetch(e.href,o)}})();const I="modulepreload",M=function(m){return"/los-planetas/"+m},L={},x=function(d,s,u){let e=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),c=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));e=Promise.allSettled(s.map(a=>{if(a=M(a),a in L)return;L[a]=!0;const t=a.endsWith(".css"),l=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${l}`))return;const i=document.createElement("link");if(i.rel=t?"stylesheet":I,t||(i.as="script"),i.crossOrigin="",i.href=a,c&&i.setAttribute("nonce",c),document.head.appendChild(i),t)return new Promise((f,g)=>{i.addEventListener("load",f),i.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})}))}function o(n){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=n,window.dispatchEvent(c),!c.defaultPrevented)throw n}return e.then(n=>{for(const c of n||[])c.status==="rejected"&&o(c.reason);return d().catch(o)})},b="/los-planetas/assets/space_helmet_1-DDP7PoAW.png",D="/los-planetas/assets/frame-B_Zca0a3.webp";window.onload=()=>{R().then(q)};const w=new Image;w.src=b;const O=new Image;O.src=D;const r=document.querySelector("canvas");r.style.width="100%";r.style.height="100%";const h=document.createElement("video");async function R(){const m=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:3840},height:{ideal:2160}}});h.srcObject=m,h.autoplay=!0,h.onloadedmetadata=()=>{r.width=h.videoWidth,r.height=h.videoHeight},await x(()=>import("@tensorflow/tfjs"),[]);const{FaceMesh:d}=await x(async()=>{const{FaceMesh:t}=await import("@mediapipe/face_mesh");return{FaceMesh:t}},[]),s=new d({locateFile:t=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${t}`});s.setOptions({maxNumFaces:5,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),s.onResults(e);const u=r.getContext("2d");function e(t){u.clearRect(0,0,r.width,r.height),u.drawImage(h,0,0,r.width,r.height),o(t.multiFaceLandmarks),u.drawImage(O,0,0,r.width,r.height)}function o(t){t&&t.forEach(l=>{const i=n(l);c(i,l)})}function n(t){const l=t.map(p=>p.x*r.width),i=t.map(p=>p.y*r.height),f=Math.min(...l),g=Math.min(...i),y=Math.max(...l)-f,v=Math.max(...i)-g;return{x:f,y:g,width:y,height:v}}function c(t,l){const{x:i,y:f,width:g,height:y}=t,v=4.6,p=l[33],_=l[263],E=Math.sqrt(Math.pow((_.x-p.x)*r.width,2)+Math.pow((_.y-p.y)*r.height,2))*v,S=w.width/w.height,P=E/S;u.drawImage(w,i+g/2-E/2,f+y/2-P/2,E,P)}async function a(){await s.send({image:h}),requestAnimationFrame(a)}a()}function q(){document.querySelector("#trigger").addEventListener("click",()=>{document.querySelector("audio").play();const d=r.toDataURL("image/png"),s=document.createElement("a");s.href=d,s.download="photo.png",s.click()})}
