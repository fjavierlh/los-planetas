(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function i(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(e){if(e.ep)return;e.ep=!0;const n=i(e);fetch(e.href,n)}})();const I="/los-planetas/assets/space_helmet_1-DDP7PoAW.png",D="/los-planetas/assets/frame-B_Zca0a3.webp";window.onload=()=>{E().then(F)};const f=new Image;f.src=I;const O=new Image;O.src=D;const t=document.querySelector("canvas");t.style.width="100%";t.style.height="100%";const a=document.createElement("video");async function E(){const g=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:3840},height:{ideal:2160}}});a.srcObject=g,a.autoplay=!0,a.onloadedmetadata=()=>{t.width=a.videoWidth,t.height=a.videoHeight};const c=new FaceMesh({locateFile:o=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${o}`});c.setOptions({maxNumFaces:5,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),c.onResults(l);const i=t.getContext("2d");function l(o){i.clearRect(0,0,t.width,t.height),i.drawImage(a,0,0,t.width,t.height),e(o.multiFaceLandmarks),i.drawImage(O,0,0,t.width,t.height)}function e(o){o&&o.forEach(s=>{const r=n(s);h(r,s)})}function n(o){const s=o.map(d=>d.x*t.width),r=o.map(d=>d.y*t.height),m=Math.min(...s),u=Math.min(...r),p=Math.max(...s)-m,y=Math.max(...r)-u;return{x:m,y:u,width:p,height:y}}function h(o,s){const{x:r,y:m,width:u,height:p}=o,y=4.6,d=s[33],x=s[263],w=Math.sqrt(Math.pow((x.x-d.x)*t.width,2)+Math.pow((x.y-d.y)*t.height,2))*y,L=f.width/f.height,M=w/L;i.drawImage(f,r+u/2-w/2,m+p/2-M/2,w,M)}async function v(){await c.send({image:a}),requestAnimationFrame(v)}v()}function F(){document.querySelector("#trigger").addEventListener("click",()=>{document.querySelector("audio").play();const c=t.toDataURL("image/png"),i=document.createElement("a");i.href=c,i.download="photo.png",i.click()})}
